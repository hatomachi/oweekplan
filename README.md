# 🗓️ Obsidian Weekplan Plugin (AI協働タイムブロッキング)

このプラグインは、Obsidian上で動作する「7つの習慣」に準拠した週間タイムブロッキング・ツールです。
単なる予定管理ではなく、**AI（GeminiやClaude等）を優秀な秘書として活用し、自分にとっての「大きな石（第2領域）」を確実に配置するための作戦会議システム**として設計されています。

## ✨ 主な特徴 (Features)

* **🤖 AIとのシームレスな協働 (AI-Driven Planning):**
* 自然言語のMarkdown表（今週の目標）をAIに渡し、専用のYAMLフォーマット（`.weekplan`）に変換させることで、スケジューリングのたたき台を一瞬で作成できます。
* AIの「石の配置の考え方（Insight）」を画面上に表示し、AIの思考プロセスを確認しながら計画を練ることができます。


* **🧩 直感的な予実管理 (Drag & Drop Interface):**
* AIが配置を見送った「未配置タスク（🟡 Pool）」を、マウスのドラッグ＆ドロップでカレンダーの空き時間に直接配置できます。
* カレンダー上の予定を伸縮させたり移動させたりすると、裏側のYAMLデータがリアルタイムで自動更新されます。


* **🏢 会社の予定との完全統合 (Outlook Integration):**
* ボタン一つでローカルの「クラシックOutlook」から直近の予定を取得し、カレンダー上にグレーのブロックとして自動展開します。（※Windows環境・Python連携必須）


* **🛡️ 柔軟な手動編集 (Source Mode & Quick Add):**
* AIに頼らずとも、Obsidian純正のモーダルUIから「＋タスク追加」が可能です。
* いつでもYAMLの直接編集（ソースモード）に切り替えられ、Obsidianの哲学である「生データへのアクセス」を保証します。



---

## 🚀 インストールと初期設定 (Setup)

### 1. プラグインのインストール

1. このリポジトリのファイルを、ObsidianのVault内の `.obsidian/plugins/obsidian-weekplan/` フォルダに配置します。
2. ターミナルで同フォルダに移動し、`npm install` と `npm run build` を実行します。
3. Obsidianの設定 > コミュニティプラグイン から「Weekplan」を有効化します。

### 2. Outlook連携の準備 (Windows環境のみ)

会社のOutlook予定を同期するためには、Python環境が必要です。

1. WindowsPCにPythonをインストールし、コマンドプロンプトで以下を実行します。
```bash
pip install pywin32

```


2. 提供されている `fetch_outlook.py` を、**ObsidianのVaultの直下**（一番上の階層）に配置してください。

---

## 📖 基本的な使い方 (Workflow)

このツールは、毎週の「作戦会議（プランニング）」で真価を発揮します。

### Step 1: 作戦会議ファイルの作成

Obsidianのコマンドパレット（`Ctrl/Cmd + P`）を開き、**「今週の作戦会議ファイルを作成」** を実行します。
`2026-W08.weekplan` のような専用ファイルが生成され、2ペインのUIが開きます。

### Step 2: 既存予定の同期

画面右上の **「🔄 Outlook同期」** ボタンを押します。
裏側でPythonが動き、Outlookの定例会議などがカレンダー上にセットされます。

### Step 3: AIへのプロンプト送信

「7つの習慣」に基づき、今週の役割と目標をMarkdownの表で整理します。
その後、AI（Gemini等）に対して専用のプロンプト（※別紙 `AI_HANDOVER.md` 参照）と目標表を投げ、「今週のスケジュール案（YAML）」を作らせます。

### Step 4: UIでの微調整（パズル）

AIが出力したYAMLをコピーし、右上の **「</> ソースモード」** を押してペーストします。
「👁️ ビジュアルモード」に戻ると、AIの提案が画面に反映されます。

* **🟢 Scheduled:** すべての時間が見積もり通りにカレンダーに配置されたタスク。
* **🌓 Partial:** 一部の時間だけカレンダーに配置されたタスク。残りの時間を再度ドラッグ＆ドロップで配置可能です。
* **🟡 Pool:** 時間がなくてAIが配置を見送った（未配置の）タスク。左ペインからカレンダーの空き時間にドラッグ＆ドロップして配置できます。
* **☑️ Completed:** 完了したタスク。
* **ー Dropped:** 実施を見送ったタスク。
* 💡 左端のアイコンをクリックすることで、手動ステータス(`Completed`, `Dropped`) と 自動計算ステータス(`Pool`, `Partial`, `Scheduled`) をループで切り替え可能です。
* 予定の長さを変更・分割したい場合は、カレンダー上で枠を伸縮し、残りの時間（左側に🌓アイコンと一緒に表示）を再度カレンダーにドラッグしてください。
* 予定枠を取り消したい場合は、カレンダーのブロックをクリックして削除してください。

---

## 🧠 設計思想 (Philosophy)

**「1日の稼働の60%しかタスクを詰め込まない」**

このツールは、スケジュールを隙間なく埋めることを目的としていません。
マネージャー職特有の「突発的な割り込み」や「体調の波」を吸収するため、意図的に【空白（バッファ）】を残すことをAIへの最強の制約としています。

「やらないこと（勇気ある見送り）」を可視化し、健康という最重要の器を守りながら、本当に大切な「第2領域」に集中するためのパートナーとしてご活用ください。

---

## 💻 開発情報

* **動作環境:** Obsidian Desktop (Windows/Mac)
* **依存関係:** FullCalendar (`@fullcalendar/core`, `@fullcalendar/timegrid`, `@fullcalendar/interaction`), `js-yaml`
